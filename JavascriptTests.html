<input type="submit" value="Generate Attributes" onclick="createRolls();return null;"/>
<script>
var rolls = 0;
function createRolls() {
	rolls+=1;
	document.body.innerHTML = "";
	document.writeln("<input type='submit' value='Generate Attributes: " + rolls + "' onclick='createRolls();return null;'/>");
	document.writeln("<table border='0' cellpadding='4' cellspacing='0'>");
	for(var i=1;i<=10;i++) {
		document.writeln("<tr style='background-color:" + background(i) + "'>");
		document.writeln("<td>"+i+"</td>");
		rollAttrSet();
		document.writeln("</tr>");
	}
	document.writeln("</table>");
	document.writeln("<a id='downloadlink'>Click to download rolls</a>");
    var b = document.body.innerHTML;
	var a = document.getElementById('downloadlink');
    a.setAttribute('download', 'rolls.html');
    a.setAttribute('href', 'data:text/html;charset=UTF-8,'+b);
}

function downloadRolls() {
}

function background(n) {
	return n % 2 == 0 ? "#FFFFFF" : "#F0F0F0"; 
}

function rollAttrSet() {
	var physique = roll(4);
	var agility = roll(4);
	var endurance = roll(4);
	var intelligence = roll(4);
	var faith = roll(4);
	var charisma = roll(4);
	var appearance = roll(4);
	var bravery = roll(4);
	var socialclass = roll(4);
	var leadership = ((2*charisma)+(2*appearance)+(2*physique)+(2*intelligence)+(2*bravery)+(2*socialclass))/10;
	var greed = roll(4);
	var selfishness = roll(4);
	var lust = roll(4);
	var bonus = die(1,6)+die(1,6)-7;
	formatAttr("Physique",physique);
	formatAttr("Agility",agility);
	formatAttr("Endurance",endurance);
	document.writeln("<td colspan=2>|</td>");
	formatAttr("Intelligence",intelligence);
	formatAttr("Faith",faith);
	document.writeln("<td colspan=2>|</td>");
	formatAttr("Charisma",charisma);
	formatAttr("Appearance",appearance);
	formatAttr("Bravery",bravery);
	document.writeln("<td colspan=2>|</td>");
	formatAttr("Leadership",leadership);
	document.writeln("<td colspan=2>|</td>");
	formatAttr("Social Class",socialclass);
	document.writeln("<td colspan=2>|</td>");
	formatAttr("Bonus Points",bonus);
}

function roll(n) {
    var a = Array(n);
    for (var i = 0; i < n; i++)
        a[i] = Math.floor(Math.random() * 6) + 1;
    a = a.sort().slice(n - 3, n);
    return a[0] + a[1] + a[2];
}

function die(min, max) {
    return Math.round((Math.random() * (max - min) + min));
}

function formatAttr(attr, n){
	document.writeln("<td>"+attr+"</td><td>"+n+"</td>");
}
</script>
