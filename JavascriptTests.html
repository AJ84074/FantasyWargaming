<html>
<head>
</head>
<body>
	<style>body,table,tr,td,input{font:normal 8pt Tahoma}</style>
	<input type="submit" value="Generate Attributes" onclick="createRolls3();return null;"/></br>
	<script>
	var rolls = 0;
	var numDice = 0;
	
	function createRolls3() {
		numDice = 3;
		createRolls();
	}
	
	function createRolls4() {
		numDice = 4;
		createRolls();
	}
	
	function createRolls() {
		rolls+=1;
		document.body.innerHTML = "";
		document.writeln("<body>");
		document.writeln("<style>body,table,tr,td,input{font:normal 8pt Tahoma}.outlineGood{color: black;-webkit-text-fill-color: white;-webkit-text-stroke-width: 1px;-webkit-text-stroke-color: black;}.outlineBad{color: black;-webkit-text-fill-color: red;-webkit-text-stroke-width: 1px;-webkit-text-stroke-color: black;}</style>");
		document.writeln("<input type='submit' value='Generate Attributes (Rolls : " + rolls + ")' onclick='createRolls();return null;'/><br/>");
		document.writeln("<br/>");
		document.writeln("<table border='0' cellpadding='4' cellspacing='0'>");
		for(var i=1;i<=10;i++) {
			document.writeln("<tr style='background-color:" + background(i) + "'>");
			document.writeln("<td>"+i+"</td>");
			rollAttrSet();
			document.writeln("</tr>");
		}
		document.writeln("</table>");
		document.writeln("<br/>");
		document.writeln("<a id='downloadlink'>Click to download rolls</a>");
		var b = document.body.innerHTML;
		var a = document.getElementById('downloadlink');
		a.setAttribute('download', 'rolls.html');
		a.setAttribute('href', 'data:text/html;charset=UTF-8,'+b);
		document.writeln("</body>");
	}

	function downloadRolls() {
	}

	function background(n) {
		return n % 2 == 0 ? "#FFFFFF" : "#F0F0F0"; 
	}

	function rollAttrSet() {
		var dice = 4;
		var physique = roll(dice);
		var agility = roll(dice);
		var endurance = roll(dice);
		var intelligence = roll(dice);
		var faith = roll(dice);
		var charisma = roll(dice);
		var appearance = roll(dice);
		var bravery = roll(dice);
		var socialclass = die(1,5)+die(1,5)+die(1,5);
		var leadership = ((2*charisma)+(2*appearance)+(2*physique)+(2*intelligence)+(2*bravery)+(2*socialclass))/10;
		var greed = roll(dice);
		var selfishness = roll(dice);
		var lust = roll(dice);
		var bonus = die(1,6)+die(1,6)-7;
		formatAttr("Phy",physique);
		formatAttr("Agi",agility);
		formatAttr("End",endurance);
		document.writeln("<td colspan=2>|</td>");
		formatAttr("Int",intelligence);
		formatAttr("Faith",faith);
		document.writeln("<td colspan=2>|</td>");
		formatAttr("Cha",charisma);
		formatAttr("App",appearance);
		formatAttr("Bra",bravery);
		document.writeln("<td colspan=2>|</td>");
		formatAttr("SC",socialclass);
		document.writeln("<td colspan=2>|</td>");
		formatAttr("Lead",leadership.toFixed(1));
		document.writeln("<td colspan=2>|</td>");
		formatAttr("Greed",greed);
		formatAttr("Self",selfishness);
		formatAttr("Lust",lust);
		document.writeln("<td colspan=2>|</td>");
		formatAttr("Bonus",bonus);
		document.writeln("<td colspan=2>|</td>");
		formatAttr("Total",physique+agility+endurance+intelligence+faith+charisma+appearance+bravery+socialclass+greed+selfishness+lust+bonus);
	}

	function roll(n) {
		var a = Array(n);
		for (var i = 0; i < n; i++)
			a[i] = Math.floor(Math.random() * 6) + 1;
		a = a.sort().slice(n - 3, n);
		return a[0] + a[1] + a[2];
	}

	function die(min, max) {
		return Math.round((Math.random() * (max - min) + min));
	}

	function formatAttr(attr, n) {
		var font = "";
		var cls = "";
		if ((n>=16 && n<=18) && (attr!="Greed" && attr!="Self" && attr!="Lust" && attr!="Bonus")) {
			font="font-weight:bold;color:black;";
		} else if ((n>=3 && n<=5) && (attr!="Greed" && attr!="Self" && attr!="Lust" && attr!="Bonus")) {
			font="font-weight:bold;color:red;";
		} else if ((n>=16 && n<=18)) {
			font="font-weight:bold;color:red;";
		} else if ((n>=3 && n<=5) && (attr!="Greed" && attr!="Self" && attr!="Lust" && attr!="Bonus")) {
			font="font-weight:bold;color:black;";
		}
		document.writeln("<td style='" + font + "'>"+attr+" :</td><td align='right' style='" + font + "'>"+n+"</td>");
	}
	
	Number.prototype.pad = function(size) {
      var s = String(this);
      while (s.length < (size || 2)) {s = "0" + s;}
      return s;
    }
	</script>
</body>
</html>
